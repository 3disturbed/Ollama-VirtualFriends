<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Friends Chat</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div id="app">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-header">
                <h2>Chats</h2>
                <div>
                    <button class="icon-btn" id="settings-btn" title="Settings">‚öôÔ∏è</button>
                    <button class="icon-btn" id="add-contact-btn" title="Add Friend">+</button>
                    <button class="icon-btn" id="create-group-btn" title="Create Group">üë•</button>
                </div>
            </div>
            <div class="sidebar-tabs">
                <button class="tab-btn active" id="tab-contacts">Friends</button>
                <button class="tab-btn" id="tab-groups">Groups</button>
            </div>
            <div class="contact-list" id="contact-list">
                <!-- Contacts injected here -->
            </div>
            <div class="contact-list hidden" id="group-list">
                <!-- Groups injected here -->
            </div>
        </div>

        <!-- Main Chat Area -->
        <div class="main-area">
            <div id="empty-state" style="display: flex; justify-content: center; align-items: center; height: 100%; color: #888;">
                <h2>Select a chat to start messaging</h2>
            </div>

            <div id="chat-area" class="hidden" style="display: flex; flex-direction: column; height: 100%;">
                <div class="chat-header">
                    <div class="chat-header-info">
                        <h3 id="chat-title">Name</h3>
                        <span id="chat-subtitle" style="font-size: 0.8rem; color: #666;">Virtual Friend</span>
                    </div>
                    <div class="chat-actions">
                        <button id="profile-btn">Profile / Memory</button>
                    </div>
                </div>

                <div class="messages-container" id="messages">
                    <!-- Messages injected here -->
                </div>

                <div class="input-area">
                    <input type="text" id="message-input" placeholder="Type a message..." autocomplete="off">
                    <button id="send-btn">Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Add Contact Modal -->
    <div class="modal" id="contact-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add New Friend</h3>
                <button class="icon-btn close-modal"></button>
            </div>
            <form id="contact-form">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="contact-name" required placeholder="e.g. Alice">
                </div>
                <div class="form-group">
                    <label>Personality (System Prompt)</label>
                    <textarea id="contact-personality" required placeholder="e.g. You are a helpful and cheerful assistant who loves gardening."></textarea>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Create Friend</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Create Group Modal -->
    <div class="modal" id="group-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Group Chat</h3>
                <button class="icon-btn close-modal"></button>
            </div>
            <form id="group-form">
                <div class="form-group">
                    <label>Group Name</label>
                    <input type="text" id="group-name" required placeholder="e.g. The Squad">
                </div>
                <div class="form-group">
                    <label>Select Members</label>
                    <div id="group-members-select" style="max-height: 150px; overflow-y: auto; border: 1px solid #ddd; padding: 10px;">
                        <!-- Checkboxes injected here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Create Group</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Settings</h3>
                <button class="icon-btn close-modal"></button>
            </div>
            <form id="settings-form">
                <div class="form-group">
                    <label>Ollama Model</label>
                    <input type="text" id="setting-model" required placeholder="gemma3:4b">
                </div>
                <div class="form-group">
                    <label>Ollama Endpoint</label>
                    <input type="text" id="setting-endpoint" required value="http://127.0.0.1:11434/api/chat">
                </div>
                <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Save Settings</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Profile / Memory Modal -->
    <div class="modal" id="profile-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Contact Profile</h3>
                <button class="icon-btn close-modal"></button>
            </div>
            <form id="profile-form">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="edit-name" required>
                </div>
                <div class="form-group">
                    <label>Personality</label>
                    <textarea id="edit-personality" required></textarea>
                </div>
                <div class="form-group">
                    <label>Current Memory (Auto-updated)</label>
                    <div id="profile-memory-display" class="memory-display"></div>
                </div>
                <div class="modal-footer" style="justify-content: space-between;">
                    <button type="button" id="delete-contact-btn" class="btn btn-danger">Delete Contact</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>
